# 알림톡 템플릿 vs 로직 불일치 분석 보고서

## 개요
현재 프로젝트의 알림톡 템플릿(`.txt`) 내용과 실제 코드(`notificationApiClient.ts`)에서 전송하는 변수 간의 불일치 사항을 분석합니다.

## 분석 상세

### Batch 1 (01~05)

#### 01. 호스트 등록 완료 (`01_호스트_등록완료.txt`)
- **템플릿 필요 변수**: `#{host_id}`, `#{date}`, `#{time}`
- **현재 코드 전송**: `#{representative_id}`, `#{date}`, `#{time}`
- **불일치**: `#{host_id}` 대신 `#{representative_id}`를 사용 중.

#### 02. 게스트 신청 완료 (`02_게스트_신청완료.txt`)
- **템플릿 필요 변수**: `#{guest_id}`, `#{date}`, `#{time}`, `#{host_id}`, `#{team_intro}`
- **현재 코드 전송**: `#{representative_id}`, `#{date}`, `#{time}`, `#{host_university}`
- **불일치**: 
    - `#{guest_id}` 누락 (대신 `#{representative_id}` 전송)
    - `#{host_id}` 누락 (대신 `#{host_university}` 전송)
    - `#{team_intro}` **완전 누락**

#### 03. 호스트에게 새 신청자 알림 (`03_호스트_새신청알림.txt`)
- **템플릿 필요 변수**: `#{host_id}`, `#{date}`, `#{time}`, `#{guest_id}`, `#{guest_university}`, `#{guest_department}`, `#{guest_gender}`, `#{guest_count}`, `#{guest_avg_age}`, `#{curr_guest_num}`, `#{max_guest_num}`
- **현재 코드 전송**: `#{representative_id}`, `#{date}`, `#{time}`, `#{guest_university}`, `#{guest_gender}`, `#{guest_avg_age}`, `#{guest_count}`, `#{guest_representative_id}`
- **불일치**:
    - `#{host_id}` 누락
    - `#{guest_id}` 누락 (대신 `#{guest_representative_id}` 전송?)
    - `#{guest_department}` **누락**
    - `#{curr_guest_num}`, `#{max_guest_num}` **누락**

#### 04. 1차 매칭 완료 (`04_1차매칭_완료안내.txt`)
- **템플릿 필요 변수**: `#{host_id}`, `#{guest_id}`, `#{date}`, `#{time}`
- **현재 코드 전송**: `#{date}`, `#{time}`, `#{other_team_university}`
- **불일치**:
    - `#{host_id}`, `#{guest_id}` **누락**
    - `#{other_team_university}`는 템플릿 본문에는 없으나 코드에서 전송 중 (제거 필요?)

#### 05. 매칭 미선택 알림 (`05_매칭_미선택알림.txt`)
- **템플릿 필요 변수**: `#{date}`, `#{time}`
- **현재 코드 전송**: `#{date}`, `#{time}`
- **결과**: ✅ **일치함**

### Batch 2 (06~10)

#### 06. 정보 열람 결제 안내 (`06_정보열람_결제안내.txt`)
- **템플릿 필요 변수**: `#{date}`, `#{time}`
- **현재 코드 전송**: `#{date}`, `#{time}`, `#{fee}`, `#{payment_link}`
- **불일치**:
    - 코드에서 수수료와 결제링크를 보내지만, **템플릿은 하드코딩된 값**을 사용 중. (변수 무시됨)

#### 07. 정보 전달 및 진행 확인 (`07_정보전달_진행확인.txt`)
- **템플릿 필요 변수**: `#{date}`, `#{time}`, `#{member_info}`
- **현재 코드 전송**: `#{date}`, `#{time}`, `#{member_info}`
- **결과**: ✅ **일치함**

#### 08. 정보 비공개 진행 확인 (`08_정보비공개_진행확인.txt`)
- **결과**: ✅ **일치함**

#### 09. 상대팀 프로세스 대기 (`09_상대팀_프로세스대기.txt`)
- **결과**: ✅ **일치함**

#### 10. 최종 매칭 결제 안내 (`10_최종매칭_결제안내.txt`)
- **템플릿 필요 변수**: `#{date}`, `#{time}`, `#{amount}`
- **현재 코드 전송**: `#{date}`, `#{time}`, `#{amount}`, `#{paymentLink}`
- **불일치**:
    - 코드에서 `#{paymentLink}` (CamelCase)를 보내지만 템플릿은 사용 안 함.
    - 템플릿은 계좌정보 하드코딩 사용.

### 운영 정책 업데이트 (User Feedback)
- **정보열람료**: 하드코딩 유지 (3000원 고정 예정). 변수 사용 안 해도 무방함.
- **결제링크**: 사용 안 함 (계좌이체). 코드에서 보내더라도 무시해도 됨.
- **최종결제금액**: **성별에 따라 다르므로 변수 처리 필수**. (현재 Temp 10은 `#{amount}`를 사용하고 있어 문제 없음 확인 필요)

### Batch 3 (11~15)

#### 11. 최종 매칭 완료 (`11_최종매칭_완료.txt`)
- **템플릿 필요 변수**: `#{host_id}`, `#{guest_id}`, `#{date}`, `#{time}`
- **현재 코드 전송**: `#{date}`, `#{time}`, `#{other_team_university}`
- **불일치**:
    - `#{host_id}`, `#{guest_id}` **누락**. (코드: 상대 대학명 전송 → 템플릿 사용 안함)

#### 12 ~ 15. 취소 및 상태 변경 알림
- 12 (프로세스 취소), 13 (호스트 취소), 14 (게스트 본인 취소), 15 (게스트 취소→호스트 알림)
- **결과**: ✅ **모두 일치함** (날짜, 시간만 사용)

### Batch 4 (16~21)

#### 16 ~ 17. 게스트 1차 매칭 전 취소
- 16 (본인 알림), 17 (호스트 알림)
- **결과**: ✅ **모두 일치함**

#### 18 ~ 19. 취소 및 환불 안내
- 18 (환불 안내), 19 (환불 불가)
- **결과**: ✅ **일치함** (변수 없음)

#### 20. 매칭 리마인더 D-1 (`20_매칭_리마인더_D-1.txt`)
- **템플릿 필요 변수**: `#{date}`, `#{time}`
- **현재 코드 전송**: `#{date}`, `#{time}`
- **결과**: ✅ **일치함**

#### 21. 학생증 반려 알림 (`21_학생증_반려_알림.txt`)
- **결과**: ✅ **일치함** (변수 없음)

## 🛠️ 수정 필요 항목 요약

| ID | 템플릿명 | 누락/불일치 변수 | 비고 |
|----|----------|------------------|------|
| **01** | 호스트 등록완료 | `host_id` | 코드에선 `representative_id`로 전송 중 |
| **02** | 게스트 신청완료 | `guest_id`, `host_id`, `team_intro` | 코드에서 주요 정보 누락 |
| **03** | 호스트 새신청 | `host_id`, `guest_id`, `guest_department` 등 | 학과 및 인원 통계 누락 |
| **04** | 1차 매칭 완료 | `host_id`, `guest_id` | 양팀 ID 미전송 |
| **11** | 최종 매칭 완료 | `host_id`, `guest_id` | 양팀 ID 미전송 |

**조치 계획**:
- `lib/notificationApiClient.ts` 함수 시그니처 변경 (누락된 인자 추가)
- 호출하는 컴포넌트(`ReservationSystem`, `useMatchingFlow` 등)에서 해당 데이터 조회 및 전달 로직 추가
